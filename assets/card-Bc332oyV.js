import{c as B,r,j as s,B as I,m as x}from"./index-Dcx6mcxo.js";import{i as E,c as H,D as V,a as U,e as _,f as q,g as z,d as G}from"./ticketing-CaVvnitd.js";import{A as J,S as m}from"./useAccessibility-kB6Fc05v.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=B("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),os=({isOpen:t,onClose:e,onConfirm:a,eventName:N,priceInSats:c,seatLabel:g,policy:n,ticketTemplate:o,issuerSignature:A,eventImageUrl:O})=>{const[h,y]=r.useState(!1),[j,u]=r.useState(!1),w=Math.floor(c*.03),C=500,k=c+w+C,p=r.useMemo(()=>E(c,n),[c,n]),f=r.useMemo(()=>H(n),[n]),F=r.useMemo(()=>`76a914${Math.random().toString(16).slice(2,42).padEnd(40,"0").slice(0,40)}88ac`,[t]),S=async()=>{if(Math.random()<.3&&!j){u(!0);return}y(!0),await new Promise(T=>setTimeout(T,2e3));const i=`tx_${Date.now()}`,d=`${o.ticketId}_${Math.random().toString(36).slice(2,8)}`,L=`${i}:0`,b=G(o.eventId,d,f),v=A??o.issuerSignature,D=v&&v===b?v:b,R=[{lockingScript:F,satoshis:1,outputDescription:"Ticket output"},...p],P=new Date().toISOString(),M={id:d,eventId:o.eventId,eventName:N,seat:g,validFrom:o.validFromISO,validTo:o.validToISO,outpoint:L,status:"VALID",priceInSats:c,pushDropFields:[o.protocolAddr,o.eventId,d,o.seatCiphertext,o.validFromISO,o.validToISO,f,D],policy:n,policyJson:f,issuerSignature:D,eventImageUrl:O,provenance:[{txid:i,salePriceSats:c,outputs:R,type:"primary",timestampISO:P}],lastTransferTx:{txid:i,salePriceSats:c,outputs:R,type:"primary",timestampISO:P}};a(M),y(!1),u(!1),e()},$=()=>{u(!1),S()};return s.jsx(V,{open:t,onOpenChange:e,children:s.jsxs(U,{className:"bg-neo-contrast-inverse border-neo-border/20 text-neo-contrast max-w-md max-h-[85vh] flex flex-col",children:[s.jsx(_,{children:s.jsx(q,{className:"font-mono uppercase text-center",children:"PURCHASE TICKET"})}),j?s.jsx(J,{onVerify:$,actionType:"purchase"}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-neo-contrast mb-2",children:N}),s.jsx("p",{className:"text-sm text-neo-contrast/70",children:g})]}),s.jsx(m,{className:"bg-neo-contrast/20"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Ticket Price"}),s.jsxs("span",{children:[c.toLocaleString()," sats"]})]}),s.jsx(m,{className:"bg-neo-contrast/20"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Ticket Price"}),s.jsxs("span",{children:[c.toLocaleString()," sats"]})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Service Fee (3%)"}),s.jsxs("span",{children:[w.toLocaleString()," sats"]})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Network Fee"}),s.jsxs("span",{children:[C.toLocaleString()," sats"]})]}),s.jsx(m,{className:"bg-neo-contrast/20"}),s.jsxs("div",{className:"flex justify-between font-bold",children:[s.jsx("span",{children:"Total"}),s.jsxs("span",{children:[k.toLocaleString()," sats"]})]})]}),s.jsxs("div",{className:"text-xs text-neo-contrast/60 font-mono",children:["✓ No hidden fees",s.jsx("br",{}),"✓ Artist/venue receives share of resales",s.jsx("br",{}),"✓ Instant transfer to your wallet"]}),s.jsx(m,{className:"bg-neo-contrast/20"}),s.jsxs("div",{className:"space-y-3 text-xs font-mono text-neo-contrast/70",children:[s.jsx("div",{className:"uppercase tracking-wide text-neo-contrast/40",children:"Ticket Policy"}),s.jsxs("div",{children:["Resale: ",n.resaleAllowed?"Allowed":"Disabled"]}),s.jsxs("div",{children:["Royalty: ",(n.royaltyBps/100).toFixed(2),"%"]}),s.jsxs("div",{children:["Issuer: ",n.issuerId]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"text-neo-contrast/50",children:"Primary Split"}),p.map((l,i)=>{var d;return s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:((d=n.primaryRecipients[i])==null?void 0:d.id)??`Recipient ${i+1}`}),s.jsxs("span",{children:[l.satoshis.toLocaleString()," sats"]})]},`${l.lockingScript}-${i}`)})]})]})]}),s.jsxs("div",{className:"text-xs text-neo-contrast/60 font-mono",children:["✓ No hidden fees",s.jsx("br",{}),"✓ Artist/venue receives share of resales",s.jsx("br",{}),"✓ Instant transfer to your wallet"]}),s.jsx(m,{className:"bg-neo-contrast/20"}),s.jsxs("div",{className:"space-y-3 text-xs font-mono text-neo-contrast/70",children:[s.jsx("div",{className:"uppercase tracking-wide text-neo-contrast/40",children:"Ticket Policy"}),s.jsxs("div",{children:["Resale: ",n.resaleAllowed?"Allowed":"Disabled"]}),s.jsxs("div",{children:["Royalty: ",(n.royaltyBps/100).toFixed(2),"%"]}),s.jsxs("div",{children:["Issuer: ",n.issuerId]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"text-neo-contrast/50",children:"Primary Split"}),p.map((l,i)=>{var d;return s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:((d=n.primaryRecipients[i])==null?void 0:d.id)??`Recipient ${i+1}`}),s.jsxs("span",{children:[l.satoshis.toLocaleString()," sats"]})]},`${l.lockingScript}-${i}`)})]})]})]}),s.jsxs(z,{className:"gap-2",children:[s.jsx(I,{variant:"neo-outline",onClick:e,disabled:h,className:"flex-1",children:"CANCEL"}),!j&&s.jsx(I,{variant:"neo",onClick:S,disabled:h,className:"flex-1",children:h?"PROCESSING...":"CONFIRM PURCHASE"})]})]})})};var K=r.createContext(void 0);function is(t){const e=r.useContext(K);return t||e||"ltr"}const Q=r.forwardRef(({className:t,...e},a)=>s.jsx("div",{ref:a,className:x("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));Q.displayName="Card";const W=r.forwardRef(({className:t,...e},a)=>s.jsx("div",{ref:a,className:x("flex flex-col space-y-1.5 p-6",t),...e}));W.displayName="CardHeader";const X=r.forwardRef(({className:t,...e},a)=>s.jsx("h3",{ref:a,className:x("text-2xl font-semibold leading-none tracking-tight",t),...e}));X.displayName="CardTitle";const Y=r.forwardRef(({className:t,...e},a)=>s.jsx("p",{ref:a,className:x("text-sm text-muted-foreground",t),...e}));Y.displayName="CardDescription";const Z=r.forwardRef(({className:t,...e},a)=>s.jsx("div",{ref:a,className:x("p-6 pt-0",t),...e}));Z.displayName="CardContent";const ss=r.forwardRef(({className:t,...e},a)=>s.jsx("div",{ref:a,className:x("flex items-center p-6 pt-0",t),...e}));ss.displayName="CardFooter";export{rs as C,os as P,Q as a,Z as b,is as u};
